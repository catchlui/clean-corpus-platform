run:
  run_id: "MultiFile_Example_2026-01-29"
  out_dir: "storage_multifile"
  shard_docs: 10
  log_every_docs: 5
  checkpoint_every_docs: 10
  policy_version: "policy_v1"

execution:
  mode: local

sources:
  # Example 1: Single file (original behavior - still supported)
  - name: "single_file"
    type: "batch"
    kind: "local_jsonl"
    dataset: "examples/sample_internal.jsonl"
    split: "train"
    text_field: "text"
    license_field: "license"
    url_field: "url"

  # Example 2: Multiple files in a list (all processed together as one source)
  # This is the recommended way to process multiple files together
  - name: "all_sample_files"
    type: "batch"
    kind: "local_jsonl"
    dataset:
      - "examples/sample_internal.jsonl"
      - "examples/sample_additional.jsonl"
      - "examples/sample_tech.jsonl"
    split: "train"
    text_field: "text"
    license_field: "license"
    url_field: "url"

  # Example 3: Directory (processes all .jsonl files in the directory)
  # Uncomment to use:
  # - name: "directory_source"
  #   type: "batch"
  #   kind: "local_jsonl"
  #   dataset: "examples/"  # Processes all .jsonl files in examples/
  #   split: "train"
  #   text_field: "text"
  #   license_field: "license"
  #   url_field: "url"

  # Example 4: Glob pattern (processes matching files)
  # Uncomment to use:
  # - name: "glob_pattern"
  #   type: "batch"
  #   kind: "local_jsonl"
  #   dataset: "examples/sample_*.jsonl"  # Matches all files starting with "sample_"
  #   split: "train"
  #   text_field: "text"
  #   license_field: "license"
  #   url_field: "url"

policies:
  licenses: "src/clean_corpus/policies/defaults/licenses.yaml"
  quality: "src/clean_corpus/policies/defaults/quality.yaml"
  pii: "src/clean_corpus/policies/defaults/pii.yaml"
  curriculum: "src/clean_corpus/policies/defaults/curriculum.yaml"

stages:
  - license_gate
  - sanitize
  - exact_dedup
  - quality_gate
  - pii_policy_gate
  - semantic_simhash
  - curriculum_eligibility
